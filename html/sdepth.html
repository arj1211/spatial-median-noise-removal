<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S2 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div  class = 'S0'><span>Find spatial depth </span><span texencoding="S_{depth}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAAnCAYAAABQWiUCAAAFYklEQVRoQ+2ZZahtVRSFv6did3cnYoOK3Yoioojd3aJid4tid3crIiK2YGEhYiuCYov1w+74jmPBedt94vHOlXsOZ/267LvPWmuOOceYsccwXIwZYsAQBINgGAlDEP4Vg2EkDEHoPhImAFYH9gJWAOYBvgEeA24C3gQOA54GbujHbNOJDlMApwIHAvcAJwCvA38BswPHA7sD3wHrAc8NGggCtBtwBfAKsCXwTsXImYErgRmBbYAPBg2E6YAbgY2AqxINP1aMFCijYX5g30RE3+HQjg6LALcDS7UBQYO3BRYCTgxNBgoEBfAWYKXQYWvgrRoLN8mze/vO+ly4XSQoihcBO+Xd24ADgC/71dhW9+6UHVYGbk5adA9F8IikyIHBohMI/l8aXAZMFasVy0MGKSI6gaDdEwEHAcc2AXEpcHi/ZoNqCHcDQgFC75/RtMElqRR/6HdedAtCHRBWiXsACmZfr3EBQUPNGGcC+8TqB4Htga86oDAlMBewKGCVeQ3w2wgjp4ZZ41jvmOYt+J6tO7MOhLWBD4F3W1xyjlSSa+adzYFXuwBhF+B8YLtknBHGoLH9NMDFwIIR+Pe7AWFC4GTgfuCZFrcs7xyZ/6/S5t3mLfZMVrEHefn/QCBNninenkdx/6kbECaPtx5NydzqrmaKk4DXgC2AtzsYNRlwLjBbus4vRgAEqWofcz3wRvZfEXg4mcw0b/f7n1Wlw0wplcuM4Jea3xSD9Ox1wH5ApwwxH3BrZhBe9Pceg+CdnGkslkbu6+zvHT1vK+DJVmdWQVC47gDmTeus8FXRWyvDlF+BHYEnajafBFgtwxh/PwOwN7BZ5hLlJ57vmRukHVfMpKNGKGjrAnMCn+Ucz/N9BzrWKna1G8bw9UPL+wK45b3Rt3DEWwcfB6wDHBWtaNhWBcEy2QmRy9nAMbm0njbcNs2zSYGD878qSB5mPfERcBYgxWzEfN48k9BgS3BnEeqLWUMHKGSX5w47JLyfylzDwY7CamhrkIC57GQFRZE2/F2lAXwReABYHrgbuAD4tLn1r4LgZl722nhi4yAnt1x6XaQ1Su9U1ywxQM6XHqNQzIP3B75tSrULZGwn4A5wFC+97cWLAEs3n8t1aVQcZfnuDEPKCrpp0BK/ZADf03j7HR0isMvm2Xlp/f+oi4TxoaqXNjp2BnZtyslLAnfFw3alHizYzietMdQKaaJBpwCPA38mQjTU9wXo81xOmukM062lu1SrywACd04ynXsLtBphFI1Fy3EtltqBtDhwZ+jkBYpYCohhW8TJ8Nc4uSo4UwOG+0PRgnLGcok6y3M9XcS0GCeAGq93jU7PKBlAqkkr+e/5RoQUPjuRNNaosJcgFO/qtatjiSM6/542Xv8EKMYJgJ6szd2AemDkNPO87KfOOOA1zOsyQNEDqeEMxOm4g2FBswhsdlJPP76U2sGp8yMRXS8g/wxdU5VRMGui5fR0pg1eRiemj2ET1/Bchwm0lDHTmLn0bskAgq+4vgBY9SqQ9jaWy4p3Ad97SDnPaEzKehkJhW+HJhQVqTUSAXagPwPPZw7h9wlpoLctbJaJIArWe01e09Py+XvAMl2OO8s0/KVH8bhlu2JqfeMZR2f6LQVLSe9ZAuDngyUilEZIT0EoqdEewYsUg1R1L6cHLZf1itnGRmzVlLSO9X2vFDlF2QXowtQKRpFZy+q0pOW588HHCJJa6oqpXD2wb5AypTo1y5wWHRIMAW6sXkbC+GSW6m/lrBHVttLr1YGjEYSi7FatftD5uFfGttpnNIJQvnf4Sa9l59dLYEYbCM4qzChLh8ty+6WRHsCMNhB66eCu9xqC8A9UfwPuqkI3fHe7ZwAAAABJRU5ErkJggg==" width="32.5" height="19.5" /></span><span> for all </span><span texencoding="1 \times M" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAAAjCAYAAADokDbBAAAEgklEQVRoQ+2YWahVVRjHf1Y0EkpFUWEQJBpRET4EhdBLg2az2jwQZVFBE01GBZYVQUVQNPogKmopQQNBNhFF05NFUPSQQlphFBYVzfGLb8ni3Hv23ue27t33wl5w4Z5z9pp++/t/0yS6UYzApGIrdQvRwSxoBB3MDmZBAgWX6iyzg1mQQMGlmlrmDsAxwEJgCfB5wTOM5lK7APOBOcBcYM/Y7EngeuDXBptPA5YDR8ez3wPPAY8DG/L5dTATxBuAM2Ly2RMIZrrrbsDDwBXxxcvAhcAPNTCd9wBwTfac81YC//TOrYJ5GHABsBk4BThhAsOcDDwDzAsArwHnAVtrYJ4DPJVZ9AfAucCXw82rgrkz8HtMughYNoFhHgGsBZSsQ3nWKSzJ+yBg/ybuoU7m6QWcD6xoeIh+L1t/dSXwLLCpga9Kj+wH+DKXAvqrkQzPfzvwHTAL+CmU9n6fxZK8p4YruCSe093pLoYdYwVzR+A24G5Af3V1Q6CCNFicBtwB3Af8NSBNFXY/sDvwI3BTzNdtre+zlvJeDNwSQfekeAGzgXfbhun+e8WlLm8I9EDgsQD5NHDrCC3zgAgYqyN6664cxgMDSe9I8l4HvA08HzJ/C9DCt4wHmIMALQXSPY8NaGcBhwBCdSwKS8/ZJHm7v5H/TOCJeEB5+0JTHBnCdKxknm9cZ6ElQbqv+aSSNqWZDrwTh9Fl6Dpyt5HkrXreCyU5v8qSt9+tDZhVFpqDNFG+sUH6UuVCDXq6iq8CnBI2AB4evjhP3JO8lfWDwL5h0ccBX0Ra9XHVZm3BHA6olmJwMNiUAOkeWuIa4E7ghUzmM8Nvp8Q9j97K+9twD69EjmladRmwbbzC7AWazlkKpOudCtwDLAA+A/YOazsRyAOK8jbiXwq8EQfRah+K/3UHltFDqp4cbpuWmc5xaFzwKODTqDA+qbKAhr+ZjpmKKd9kVaZHj8TnlLj/HUp4KYD+Gdaoe9ByHVVpVOs+Mx0g95Hpu0Hy0Cqu+wQk88JkVbuGP7wq8kb7DacDBwfgb2LBFPV1B02qpf+mtWmZvcHmXsAKo2keWmeggngRuLgnOVeyJuQOq7oU6V/NFjweSJ91OxYZVk2Voy2Y/aJ2XdpUd5/8dwOJZagNjbx8TX2G9Kwv8S5AeScDs/TURTgqS8h8wzZg1qU/JYDuATwagK4FfskubYMjJe5vhl+0M5ZG3mHSGitLyDZh5rV2VdT+v0BtH9rAXZVZWLq3FZGJu6BsyeXy9pm8w1RbQg4Kc6dw4DcDX4fD/nAQvcWzTUGmpUcK1PNa9inT4aqcGZG4C1E5/5bdxc68krcp42ja99zuH/pxMRpaz9ru9y+Nj6I3aLkl1Pww/dayY39dRNJB8sgcqBe0Mvmj4kUeGV1xpWz1o/WZtCvr12Oekdruub5wY3w3BTDXPLnnrv5syiR4KyeT+b6jqc8cgSEOmWKVYZfa1KfyUD0zBWrDQcn+XOIgo7XGWMIcrTuMm3U7mAVfRQezg1mQQMGlOsvsYBYkUHCpzjILwvwX6E06M1pR0iQAAAAASUVORK5CYII=" width="41.5" height="17.5" /></span><span> point vectors </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">p</span><span> in a </span><span texencoding="N \times M" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="46.5" height="17.5" /></span><span> matrix </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">S</span><span> set of points, returned as a </span><span texencoding="N \times 1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAAjCAYAAAA6wDyZAAAD1ElEQVRoQ+2ZWchOXRTHf+9HPkOUIYULIUmKoiguJJFM+cwzRYQolLhAmTNEynCBkjmKUKbcKAlXFJIiZSgXPkMyD/21dp1Oz3nOfva73yflnHrr6Xn32sPvrL3Wf62nhuIJIlATZFUYUYALdIICXAEukECgWeFxBbhAAoFmeR73LzAMmAiMszXeA/8BVzPW7AeMBmYCLWzMeWAncCVwn9Uw+wfoC8wB1gMPyy2aB87ZNgE2A/Pti43ASuB7xuSadzGwDdgArAa+VeP0AWs4YEvMIe4AE2KB036mAwdtYzeBScCTMhtdASwERgG3Ag5UDZNuwFTgOTACGAxEBdcA2GRe5A40G9ifcbpGwHagNTAL+L8aFALW0Lm+mJ1zjKjg2gJHgPvAAKArcLoMlPbAUeCCxYufnofSFe8PtANOVHC9Zae4+wG4DPiul9zWFOBwbI9TwBc4TT4eWASUSxKD7ABy/UoSQhcD1tG8W6EhLzYKmsLGXuCxT3zKeIl1Ak6BXhCmAT3M25paplwGfE5tRuPHApOBp57epmGCMATYYxlZ85SDp8CuNXYDr4F5wMU/xeMEaBfwzDJpM4ttuhoPTKbcS8Bx4xXXSkHN4+gLLyY07Sm6x7nrswo4a6dWwN9nn5daInBxxY3fYtc7D1Sp/+fBiw2tTsCNBLba1btrp+wAHAP6lEgSpcbHhPcjdT2lv5SoQhJCnSWHesBaoDMg+fHWVkoK3GSSyBofAq5UzJN3S3TvsJgWC1p0j2sFHAKul5AVEo8nTZqonFI8a2hXWFpIZUttvSANTzJHjxJOTGjRwfUCzgEzSsgK1bEqwyRNXJKQxx23iiGrlg3xPs27HFhnxmvs89eQyaohR+Zais+q3QYmpImu0SsTxcpQLyIdKpkIlLH1KDzkSZVKl4+WVV3Z1BhYYJtNb6Z5QpqofpUEkffJO1wpU+kBkuPT2VMv55PJI3VeYsKLBs6VTadMbmQBSEoTjVHRrCqjtk8amotpmrcSkey7j2jgXNmk2vFamdWT0uRRSrb4bjo9LguaSzZ5Oi9k3SjgnKwY6lH7aaz6berPyTuTsiXkAMnaU2VUVvaMDS8KuO6WHd959N0EpzdwBlC1oHZS6OMLzc0fC159k0+SVC99eojpDnBLQJlUvSmVTnouGRTJjDcZRNQhlpY7YJovFFwna+20qUCnJeHJQ+U5SlA+j3TqGGC4/Tmb23Z7blgTNt3E+CN/kO5p/Tj9TuEroAVP0uhjLV+cD+zfY3x/c/Ce8G8ZWIALfNMFuAJcIIFAs8LjCnCBBALNCo8LBPcL7hUbM83YQfkAAAAASUVORK5CYII=" width="39" height="17.5" /></span><span> vector</span></div><div  class = 'S0'><span>Author: Arjun Bawa, Date last modified: Dec. 20, 2021</span></div><div  class = 'S0'><span>Spatial depth is defined</span></div><div  class = 'S1'><span>$S_{depth}(p, S_1, ..., S_N) = 1 - \frac{1}{N-1}\left\|\sum_{i=1}^N \frac{p - S_i}{\left\| p - S_i \right\|} \right\|$</span></div><div  class = 'S0'><span>Algorithm:</span></div><div  class = 'S0'><span>    for each </span><span texencoding="1 \times M" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAAAjCAYAAADokDbBAAAEgklEQVRoQ+2YWahVVRjHf1Y0EkpFUWEQJBpRET4EhdBLg2az2jwQZVFBE01GBZYVQUVQNPogKmopQQNBNhFF05NFUPSQQlphFBYVzfGLb8ni3Hv23ue27t33wl5w4Z5z9pp++/t/0yS6UYzApGIrdQvRwSxoBB3MDmZBAgWX6iyzg1mQQMGlmlrmDsAxwEJgCfB5wTOM5lK7APOBOcBcYM/Y7EngeuDXBptPA5YDR8ez3wPPAY8DG/L5dTATxBuAM2Ly2RMIZrrrbsDDwBXxxcvAhcAPNTCd9wBwTfac81YC//TOrYJ5GHABsBk4BThhAsOcDDwDzAsArwHnAVtrYJ4DPJVZ9AfAucCXw82rgrkz8HtMughYNoFhHgGsBZSsQ3nWKSzJ+yBg/ybuoU7m6QWcD6xoeIh+L1t/dSXwLLCpga9Kj+wH+DKXAvqrkQzPfzvwHTAL+CmU9n6fxZK8p4YruCSe093pLoYdYwVzR+A24G5Af3V1Q6CCNFicBtwB3Af8NSBNFXY/sDvwI3BTzNdtre+zlvJeDNwSQfekeAGzgXfbhun+e8WlLm8I9EDgsQD5NHDrCC3zgAgYqyN6664cxgMDSe9I8l4HvA08HzJ/C9DCt4wHmIMALQXSPY8NaGcBhwBCdSwKS8/ZJHm7v5H/TOCJeEB5+0JTHBnCdKxknm9cZ6ElQbqv+aSSNqWZDrwTh9Fl6Dpyt5HkrXreCyU5v8qSt9+tDZhVFpqDNFG+sUH6UuVCDXq6iq8CnBI2AB4evjhP3JO8lfWDwL5h0ccBX0Ra9XHVZm3BHA6olmJwMNiUAOkeWuIa4E7ghUzmM8Nvp8Q9j97K+9twD69EjmladRmwbbzC7AWazlkKpOudCtwDLAA+A/YOazsRyAOK8jbiXwq8EQfRah+K/3UHltFDqp4cbpuWmc5xaFzwKODTqDA+qbKAhr+ZjpmKKd9kVaZHj8TnlLj/HUp4KYD+Gdaoe9ByHVVpVOs+Mx0g95Hpu0Hy0Cqu+wQk88JkVbuGP7wq8kb7DacDBwfgb2LBFPV1B02qpf+mtWmZvcHmXsAKo2keWmeggngRuLgnOVeyJuQOq7oU6V/NFjweSJ91OxYZVk2Voy2Y/aJ2XdpUd5/8dwOJZagNjbx8TX2G9Kwv8S5AeScDs/TURTgqS8h8wzZg1qU/JYDuATwagK4FfskubYMjJe5vhl+0M5ZG3mHSGitLyDZh5rV2VdT+v0BtH9rAXZVZWLq3FZGJu6BsyeXy9pm8w1RbQg4Kc6dw4DcDX4fD/nAQvcWzTUGmpUcK1PNa9inT4aqcGZG4C1E5/5bdxc68krcp42ja99zuH/pxMRpaz9ru9y+Nj6I3aLkl1Pww/dayY39dRNJB8sgcqBe0Mvmj4kUeGV1xpWz1o/WZtCvr12Oekdruub5wY3w3BTDXPLnnrv5syiR4KyeT+b6jqc8cgSEOmWKVYZfa1KfyUD0zBWrDQcn+XOIgo7XGWMIcrTuMm3U7mAVfRQezg1mQQMGlOsvsYBYkUHCpzjILwvwX6E06M1pR0iQAAAAASUVORK5CYII=" width="41.5" height="17.5" /></span><span> point vector </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">p</span><span> in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">S</span><span>:</span></div><div  class = 'S0'><span>        remove any instances of </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">p</span><span> in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">S</span></div><div  class = 'S0'><span>        find sum of normalized differences between </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">p</span><span> and every other vector in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(0, 0, 0);">S</span></div><div  class = 'S0'><span>        </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >xi = sdepth(S)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    N = size(S,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    M = size(S,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     d = pdist2(S,S);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     depth = zeros([N, 1]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    out_n = zeros([N, N, M]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >i = 1:N</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >        out_n(i, :, :) = S(i,:) - S;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% normalize difference vectors to unit length</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    normalized_diff = out_n ./ vecnorm(out_n, 2, 3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% replacing all NaNs with zeros (they are formed because of two same vector)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    normalized_diff(isnan(normalized_diff)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% take sum of normalized difference vectors for each pixel</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    norm_diff_sum = squeeze(sum(normalized_diff, 2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% take the norm of these sums</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    xi = vecnorm(norm_diff_sum, 2, 2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     r = out_n ./ d;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     r1 = reshape(r(repmat(~eye(size(r,2)), [1 1 3])), [size(r,1)-1,size(r,2),size(r,3)]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     r2 = squeeze(sum(r1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     r3 = vecnorm(r2,2,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     depth = 1 - r3./(N-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
function xi = sdepth(S)
%  SDEPTH Find spatial depth $S_{depth}$ for all $1 \times M$ point vectors $p$ in a 
% $N \times M$ matrix $S$ set of points, returned as a $N \times 1$ vector
% 
% Author: Arjun Bawa, Date last modified: Dec. 20, 2021
% 
% Spatial depth is defined
% 
% $S_{depth}(p, S_1, ..., S_N) = 1 - \frac{1}{N-1}\left\|\sum_{i=1}^N \frac{p 
% - S_i}{\left\| p - S_i \right\|} \right\|$
% 
% Algorithm:
% 
% for each $1 \times M$ point vector $p$ in $S$:
% 
% remove any instances of $p$ in $S$
% 
% find sum of normalized differences between $p$ and every other vector in $S$
% 
% 
    N = size(S,1);
    M = size(S,2);
%     d = pdist2(S,S);
%     depth = zeros([N, 1]);
    out_n = zeros([N, N, M]);
    for i = 1:N
        out_n(i, :, :) = S(i,:) - S;
    end
    % normalize difference vectors to unit length
    normalized_diff = out_n ./ vecnorm(out_n, 2, 3);
    % replacing all NaNs with zeros (they are formed because of two same vector)
    normalized_diff(isnan(normalized_diff)) = 0;
    % take sum of normalized difference vectors for each pixel
    norm_diff_sum = squeeze(sum(normalized_diff, 2));
    % take the norm of these sums
    xi = vecnorm(norm_diff_sum, 2, 2);
%     r = out_n ./ d;
%     r1 = reshape(r(repmat(~eye(size(r,2)), [1 1 3])), [size(r,1)-1,size(r,2),size(r,3)]);
%     r2 = squeeze(sum(r1));
%     r3 = vecnorm(r2,2,2);
%     depth = 1 - r3./(N-1);
end
##### SOURCE END #####
-->
</div></body></html>